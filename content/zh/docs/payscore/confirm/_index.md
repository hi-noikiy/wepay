---
title: '需确认模式特有API'
linkTitle: '需确认订单'
weight: 10
description: >
  相对免确认模式, 需确认模式需要用户确认授权这步操作, 因此在需确认模式下商户需要调起微信支付分小程序, 引导用户确认订单, 我们为需确认模式特别提供了调起支付分小程序-确认订单api接口, 这些接口仅在需确认模式下需要调用, 且必须调用。
type: 'docs'
---

{{% alert title="注意" color="warning"%}}

- 需用户确认订单, 无需使用【授权服务】及【授权/解除授权服务回调通知】。

用户进入支付场景之后, 建议先通过《创建支付分订单》接口获取 package。然后通过 package 引导用户【确认订单】(《确认订单(APP）》、《确认订单(H5）》、《确认订单(小程序）》）, 如用户确认失败返回商户侧, 如用户确认成功, 商户提供服务。

业务流程图:

步骤一 商户通过《创建支付分订单》接口, 创建订单。

步骤二 若创建订单成功, 则请求【确认订单】(《确认订单(APP）》、《确认订单(H5）》、《确认订单(小程序）》）接口, 跳入调起支付分小程序。反之, 则返回商户页面(商户自己设计逻辑）。

步骤三 跳转至微信支付分小程序, 微信支付会校验用户是否符合免押条件, 未符合则需要在微信支付分小程序上支付押金。

步骤四 跳入微信支付小程序后, 若订单确认成功, 微信会通过《确认订单回调通知》接口, 主动通知商户。商户也可以通过《查询支付分订单》接口, 主动查询订单确认情况。反之, 用户未完成订单确认, 直接返回到商户页面, 则商户可自己设计逻辑。

步骤五 订单确认成功, 商户开始为用户提供服务或授权功能。

步骤六 用户结束服务, 商户根据实际情况调用《完结支付分订单》接口, 或者《取消支付分订单》接口。微信根据《完结支付分订单》接口中传递的扣款金额完成扣款。

步骤七 微信支付扣款成功后, 微信会通过《支付成功回调通知》接口立即通知商户。如扣款失败, 微信支付会周期性发起扣款请求, 直到扣款成功为止。
