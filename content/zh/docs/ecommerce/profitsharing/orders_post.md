---
title: '请求分账API'
linkTitle: '请求分账'
date: '2020-2-27'
weight: 2
description: >
  微信订单支付成功后, 由电商平台发起分账请求, 将结算后的资金分给分账接收方。
type: 'docs'
---

{{% alert title="注意:" color="warning"%}}

- 微信订单支付成功后, 服务商代特约商户发起分账请求, 将结算后的钱分到分账接收方。
- 对同一笔订单最多能发起 20 次分账请求, 每次请求最多分给 5 个接收方。
- 此接口采用异步处理模式, 即在接收到商户请求后, 会先受理请求再异步处理, 最终的分账结果可以通过查询分账接口获取。

{{% /alert %}}

## 接口说明

**适用对象**: 电商平台\
**请求 URL**: https://api.mch.weixin.qq.com/v3/ecommerce/profitsharing/orders\
**请求方式**: POST\
**接口规则**: https://wechatpay-api.gitbook.io/wechatpay-api-v3

`path` 指该参数需在请求 URL 传参\
`query` 指该参数需在请求 JSON 传参

## 请求参数

| 变量           | 类型       | 必填 | 参数名/描述/示例值                                                                                                                                                                                             |
| -------------- | ---------- | ---- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| sub_mchid      | string(32) | 是   | `二级商户号` `query` 分账出资的电商平台二级商户, 填写微信支付分配的商户号。                                                                                                                                    |
|                |            |      | 1900000109                                                                                                                                                                                                     |
| transaction_id | string(32) | 是   | `微信订单号` `query` 微信支付订单号。                                                                                                                                                                          |
|                |            |      | 4208450740201411110007820472                                                                                                                                                                                   |
| out_order_no   | string(64) | 是   | `商户分账单号` `query` 商户系统内部的分账单号, 在商户系统内部唯一(单次分账、多次分账、完结分账应使用不同的商户分账单号）, 同一分账单号多次请求等同一次。                                                       |
|                |            |      | P20150806125346                                                                                                                                                                                                |
| receivers      | array      | 是   | `+分账接收方列表` `query` 分账接收方列表, 支持设置出资商户作为分账接收方, 单次分账最多可有 5 个分账接收方                                                                                                      |
| finish         | boolean    | 是   | `是否分账完成` `query` 是否完成分账<br>1、如果为 true, 该笔订单剩余未分账的金额会解冻回电商平台二级商户；<br>2、如果为 false, 该笔订单剩余未分账的金额不会解冻回电商平台二级商户, 可以对该笔订单再次进行分账。 |
|                |            |      | true                                                                                                                                                                                                           |

### 请求示例

```json
{
  "sub_mchid": "1900000109",
  "transaction_id": "4208450740201411110007820472",
  "out_order_no": "P20150806125346",
  "receivers": [
    {
      "receiver_mchid": "1900000110",
      "amount": 100,
      "description": "分给商户 1900000110"
    }
  ],
  "finish": true
}
```

## 返回参数

| 变量           | 类型       | 必填 | 参数名/描述/示例值                                                                                                                               |
| -------------- | ---------- | ---- | ------------------------------------------------------------------------------------------------------------------------------------------------ |
| sub_mchid      | string(32) | 是   | `二级商户号` 分账出资的电商平台二级商户, 填写微信支付分配的商户号。                                                                              |
|                |            |      | 1900000109                                                                                                                                       |
| transaction_id | string(32) | 是   | `微信订单号` 微信支付订单号。                                                                                                                    |
|                |            |      | 4208450740201411110007820472                                                                                                                     |
| out_order_no   | string(64) | 是   | `商户分账单号` 商户系统内部的分账单号, 在商户系统内部唯一(单次分账、多次分账、完结分账应使用不同的商户分账单号）, 同一分账单号多次请求等同一次。 |
|                |            |      | P20150806125346                                                                                                                                  |
| order_id       | string(64) | 是   | `微信分账单号` 微信分账单号, 微信系统返回的唯一标识。                                                                                            |
|                |            |      | 6754760740201411110007865434                                                                                                                     |

### 返回示例

正常示例

```json
{
  "sub_mchid": "1900000109",
  "transaction_id": "4208450740201411110007820472",
  "out_order_no": "P20150806125346",
  "order_id": "3008450740201411110007820472"
}
```

## 错误码<sub>公共错误码</sub>

| 状态码 | 错误码            | 描述           | 解决方案                                                                                                                                                                                                                                                                                                                                                                          |
| ------ | ----------------- | -------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 500    | SYSTEM_ERROR      | 系统错误       | 系统异常, 请使用相同参数稍后重新调用                                                                                                                                                                                                                                                                                                                                              |
| 400    | PARAM_ERROR       | 参数错误       | 请使用正确的参数重新调用                                                                                                                                                                                                                                                                                                                                                          |
| 400    | INVALID_REQUEST   | 参数错误       | 请使用正确的参数重新调用<br>分账金额超限 分账金额不能大于可分金额或大于最大分账比例金额, 请调整分账金额<br>分账接收方非法 分账接收方在分账之前需要进行添加<br>请求参数不符合参数格式 请求参数错误, 检查原交易号是否存在或发起支付交易接口返回失败<br>订单处理中, 暂时无法分账 订单处理中, 暂时无法分账, 请稍后再试<br>不是分账订单, 无法分账 发起支付交易接口时请用分账的合适参数 |
| 429    | FREQUENCY_LIMITED | 频率限制       | 请降低频率后重试                                                                                                                                                                                                                                                                                                                                                                  |
| 403    | NO_AUTH           | 未开通分账权限 | 请开通商户号分账权限                                                                                                                                                                                                                                                                                                                                                              |
