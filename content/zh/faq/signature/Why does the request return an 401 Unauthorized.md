---
title: '为什么请求返回 401 Unauthorized？'
weight: 2
---

请根据报文中的 message 信息, 在下表中找到错误的原因和对应的解决方案。

| 错误描述                                                             | 原因                                                                                   | 解决方案                                                         |
| -------------------------------------------------------------------- | -------------------------------------------------------------------------------------- | ---------------------------------------------------------------- |
| 商户未设置 APIv3 密钥。                                              | 商户未设置 APIv3 密钥                                                                  | 请登陆商户平台设置 APIv3 密钥                                    |
| 商户未申请过证书。                                                   | 商户未申请过 API 证书                                                                  | 请参考什么是 API 证书？如何获取 API 证书？​                      |
| 商户证书序列号有误。                                                 | 使用了错误的商户证书, 或者使用了已经失效的历史的商户证书, 或者获取的商户证书序列号有误 | 请检查商户证书, 可登陆商户平台查看正确的证书序列号。             |
| 商户证书已过期。                                                     | 使用了已经过期的商户证书和私钥                                                         | 请到商户平台进行续期, 使用续期后的新证书                         |
| 商户证书已作废。                                                     | 使用了商户主动作废的商户证书和私钥                                                     | 请到商户平台重新申请证书后, 使用新申请的证书                     |
| 错误的签名, 导致验签失败。                                           | 使用了错误的商户私钥, 或签名串构造不正确                                               | 请见下一问题                                                     |
| Http 头 Authorization 值格式错误                                     | 缺少 Authorization 头, 或其格式不正确                                                  | 请检查上送的 Authorization                                       |
| Http 头 Authorization 认证类型不正确                                 | 不支持 Authorization 中声明的签名算法                                                  | 请检查上送的 Authorization, 目前仅支持 WECHATPAY2-SHA256-RSA2048 |
| Http 头 Authorization 中的 timestamp 与发起请求的时间不得超过 5 分钟 | Authorization 头中的时间戳 timestamp 所示时间距离当前时间超过 5 分钟                   | 请检查系统时间是否准确, 或者获取时间的逻辑是否正确               |
| 已更换证书, 请使用新证书                                             | 商户主动重新申请了商户 API 证书                                                        | 请使用新申请的商户 API 证书                                      |
